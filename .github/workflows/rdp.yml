name: RDP Tunnel

on:
  workflow_dispatch:

jobs:
  rdp:
    runs-on: windows-latest
    steps:
    - name: Enable RDP
      run: reg add "HKLM\System\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
      
    - name: Configure Firewall
      run: netsh advfirewall firewall set rule group "remote desktop" new enable=Yes
      
    - name: Create User
      run: net user RDPUser P@ssw0rd123! /add /Y
      
    - name: Add to Admin Group
      run: net localgroup administrators RDPUser /add
      
    - name: Wait 5 minutes
      run: timeout /t 300
